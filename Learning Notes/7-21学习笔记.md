# ilabåŒ»å­¦å½±åƒæš‘æœŸç§‘ç ”

2019-07-20 å¼ å–†å­¦ä¹ ç¬”è®°

[TOC]

# ç¬¬ä¸€é—¨è¯¾ ç¥ç»ç½‘è·¯å’Œæ·±åº¦å­¦ä¹ 

## ç¬¬äºŒå‘¨: ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€

1. å¦‚ä½•å¤„ç†è®­ç»ƒé›† --> æ‰“ç ´ä¹ æƒ¯çš„forå¾ªç¯éå†è®­ç»ƒé›†çš„æ¯ä¸ªæ ·æœ¬
2. ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹: å‰å‘æš‚åœ, å‰å‘ä¼ æ’­ --> åå‘æš‚åœ, åå‘ä¼ æ’­
3. é€»è¾‘å›å½’

### äºŒåˆ†ç±»

> å¼•ä¾‹: ä¸€å¼ å½©è‰²å›¾ç‰‡æ˜¯ä¸æ˜¯çŒ«?
>
> è¾“å…¥: ä¸€å¼ å›¾ç‰‡, ä¹Ÿå°±æ˜¯ä¸‰ä¸ª64*64çš„çŸ©é˜µ
>
> è¾“å‡º: ç»“æœæ ‡ç­¾(0æˆ–1), ç”¨äºè¡¨ç¤ºæ˜¯å¦ä¸ºçŒ«
>
> æˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªn<sub>x</sub>è¡¨ç¤ºè¾“å…¥ç‰¹å¾å‘é‡çš„ç»´åº¦, è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨çš„è§„åˆ™æ˜¯æŠŠrgbä¸‰ä¸ªçŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªæ•°å€¼éƒ½ä¸€æ¬¡æ’åˆ—, æœ€ç»ˆå½¢æˆçš„æ˜¯ä¸€ä¸ª64 * 64 * 3çš„ä¸€ç»´å‘é‡, æ„æˆæˆ‘ä»¬çš„é¢ç‰¹å¾å‘é‡x; æˆ‘ä»¬æ„å»ºçš„ç¥ç»ç½‘ç»œå°±æ˜¯é€šè¿‡è¿™ä¸ª12288ç»´çš„å‘é‡ä½œä¸ºè¾“å…¥, è¾“å‡º0æˆ–1, ä¹Ÿå°±æ˜¯é¢„æµ‹å›¾ç‰‡ä¸­æ˜¯å¦æœ‰çŒ«

#### ç¬¦å·å®šä¹‰

- **x:** è¾“å…¥æ•°æ®, ç»´åº¦æ˜¯ <u>n<sub>x</sub> * 1</u>

- **y:** è¾“å‡ºç»“æœ, å–å€¼æ˜¯<u>(0, 1)</u>

- **X = [x<sup>(1)</sup>, x<sup>(2)</sup>, ... , x<sup>(m)</sup>]:** æ‰€æœ‰è®­ç»ƒæ•°æ®é›†çš„è¾“å…¥å€¼, ç»´åº¦æ˜¯ <u>n<sub>x</sub> * m</u>

  *(å¦‚æœXä¸­çš„é¡¹æ˜¯æŒ‰è¡Œç»™å‡ºçš„, æˆ‘ä»¬å¯ä»¥å¯¹å…¶è½¬ç½®, ç¥ç»ç½‘ç»œä¸­ä¸€èˆ¬é‡‡ç”¨ğŸ‘‡è¿™ç§å½¢å¼)*

  ![image.png](https://upload-images.jianshu.io/upload_images/12014150-0041d596e602d544.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- **Y = [y<sup>(1)</sup>, y<sup>(2)</sup>, ... , y<sup>(m)</sup>]:** æ‰€æœ‰è®­ç»ƒæ•°æ®é›†çš„è¾“å‡ºå€¼, ç»´åº¦æ˜¯ <u>1 * m</u>

  ![image.png](https://upload-images.jianshu.io/upload_images/12014150-cdad0bb9f8dc5ebb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- **(x<sup>(i)</sup>, y<sup>(i)</sup>):** ç¬¬iä¸ªå•ç‹¬çš„æ ·æœ¬(è¾“å…¥/è¾“å‡º)

- **M<sub>train</sub>:** è®­ç»ƒæ ·æœ¬çš„ä¸ªæ•°

- **M<sub>test</sub>:** æµ‹è¯•é›†çš„æ ·æœ¬æ•°

ps. å¯ä»¥é€šè¿‡`X.shape`è·å–**X**çŸ©é˜µçš„è§„æ¨¡(n<sub>x</sub>, m), `Y.shape`è·å–**Y**çŸ©é˜µçš„è§„æ¨¡(1, m)

### é€»è¾‘å›å½’ 

#### å‡è®¾å‡½æ•°

- $\hat{y}$è¡¨ç¤ºyç­‰äº1çš„ä¸€ç§å¯èƒ½æ€§, ä¹Ÿå°±æ˜¯å¯¹å®é™…å€¼yçš„ä¼°è®¡
- wè¡¨ç¤ºé€»è¾‘å›å½’çš„å‚æ•°, ç‰¹å¾æƒé‡, ç»´åº¦ä¸ºn<sub>x</sub>, ä¸ç‰¹å¾å‘é‡ç›¸åŒ
- bè¡¨ç¤ºåå·®, æ˜¯ä¸€ä¸ªå®æ•°

å¦‚æœä»¤ $\hat{y}$ = w<sup>T</sup>x + b ä½œä¸ºyçš„é¢„æµ‹å€¼, è¿™ä¸ªå€¼ä¸åœ¨[0,1]åŒºé—´å†…, æ˜¯æ²¡æœ‰æ„ä¹‰çš„, å› æ­¤æˆ‘ä»¬çš„è¾“å‡ºåº”è¯¥å°†è¿™ä¸ªå¼å­ä½œä¸ºè‡ªå˜é‡çš„`sigmoid`å‡½æ•°, å°†çº¿æ€§å‡½æ•°è½¬æ¢ä¸ºéçº¿æ€§å‡½æ•°

![image.png](https://upload-images.jianshu.io/upload_images/12014150-e4808ee939db46f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### sigmoidå‡½æ•°

![image.png](https://upload-images.jianshu.io/upload_images/12014150-9e5d09e566b05a69.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- å€¼åŸŸå¹³æ»‘çš„ä»0èµ°åˆ°1
- çºµè½´çš„æˆªè·æ˜¯0.5

**ç›®æ ‡æ˜¯è®©æœºå™¨å­¦ä¹ å‚æ•°wå’Œbä½¿çš„$\hat{y}$æˆä¸ºy=1è¿™ä¸€æƒ…å†µæ¦‚ç‡çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¼°è®¡**

### ä»£ä»·å‡½æ•°

é€šè¿‡è®­ç»ƒä»£ä»·å‡½æ•°å¯ä»¥å¾—åˆ°å‚æ•°wå’Œå‚æ•°b => è¿›è€Œè®­ç»ƒé€»è¾‘å›å½’æ¨¡å‹

#### æŸå¤±å‡½æ•°

 L($\hat{y}$, y), ä¹Ÿå«è¯¯å·®å‡½æ•°, ç”¨æ¥è¡¡é‡é¢„æµ‹è¾“å‡ºå€¼å’Œå®é™…å€¼æœ‰å¤šæ¥è¿‘ --> ç®—æ³•çš„è¿è¡Œæƒ…å†µ

>  ä¸€èˆ¬ä½¿ç”¨ä¸æµ‹è¯•å’Œå®é™…å€¼çš„å¹³æ–¹å·®æˆ–è€…å¹³æ–¹å·®çš„ä¸€åŠ, ä½†æ˜¯ç”±äºæˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡ä¸æ˜¯å‡¸ä¼˜åŒ–, åªèƒ½æ‰¾åˆ°å¤šä¸ªå±€éƒ¨æœ€ä¼˜å€¼

L($\hat{y}$, y) = -ylog($\hat{y}$) - (1 - y)log(1 - $\hat{y}$)

æˆ‘ä»¬å¸Œæœ›é€»è¾‘å›å½’æŸå¤±å‡½æ•°å°½å¯èƒ½å°: 

- å½“y=1æ—¶, æŸå¤±å‡½æ•°L($\hat{y}$, y) = -ylog($\hat{y}$), å½“Lå°½å¯èƒ½å°æ—¶, $\hat{y}$å°±è¦å°½å¯èƒ½å¤§, å› ä¸º`sigmoid`å‡½æ•°çš„å–å€¼èŒƒå›´æ—¶[0,1], å› æ­¤$\hat{y}$æ— é™æ¥è¿‘äº1, ä¸yå¾ˆæ¥è¿‘
- å½“y=0æ—¶, æŸå¤±å‡½æ•°L($\hat{y}$, y) = -log(1 - $\hat{y}$), å½“Lå°½å¯èƒ½å°æ—¶, $\hat{y}$å°±è¦å°½å¯èƒ½å°, å› ä¸º`sigmoid`å‡½æ•°çš„å–å€¼èŒƒå›´æ—¶[0,1], å› æ­¤$\hat{y}$æ— é™æ¥è¿‘äº0, ä¸yå¾ˆæ¥è¿‘
- è¿™é—¨è¯¾ä¸­æœ‰å¾ˆå¤šå‡½æ•°: **å¦‚æœyç­‰äº1, å°±è¦è®©$\hat{y}$å°½å¯èƒ½å¤§; å¦‚æœyç­‰äº0, å°±è¦è®©$\hat{y}$å°½å¯èƒ½å°**

#### ä»£ä»·å‡½æ•°

å¯¹mä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°æ±‚å’Œç„¶åé™¤ä»¥m, æˆ‘ä»¬è¦æ‰¾åˆ°åˆé€‚çš„wå’Œbè®©ä»£ä»·å‡½æ•°Jçš„æ€»ä»£ä»·é™åˆ°æœ€ä½

$J ( w , b ) = \frac { 1 } { m } \sum _ { i = 1 } ^ { m } L \left( \hat { y } ^ { ( i ) } , y ^ { ( i ) } \right) = \frac { 1 } { m } \sum _ { i = 1 } ^ { m } \left( - y ^ { ( i ) } \log \hat { y } ^ { ( i ) } - \left( 1 - y ^ { ( i ) } \right) \log \left( 1 - \hat { y } ^ { ( i ) } \right) \right)$

### æ¢¯åº¦ä¸‹é™æ³•

é€šè¿‡æœ€å°åŒ–ä»£ä»·å‡½æ•°J(w, b)æ¥è®­ç»ƒå‚æ•°wå’Œb

å½¢è±¡åŒ–Jä¸º![image.png](https://upload-images.jianshu.io/upload_images/12014150-1ed1e8318b91c2ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä»£ä»·å‡½æ•°J(w,b)æ˜¯åœ¨æ°´å¹³è½´wå’Œbä¸Šçš„æ›²é¢, æ›²é¢çš„é«˜åº¦å°±æ˜¯J(w,b)åœ¨æŸç‚¹çš„å‡½æ•°å€¼

- é¦–å…ˆé‡‡ç”¨éšæœºåˆå§‹åŒ–æ–¹æ³•åœ¨æ›²é¢ä¸Šéšæœºå–ä¸€ç‚¹, åˆå§‹åŒ–å‚æ•°wå’Œb(å› ä¸ºå‡½æ•°ä¸ºå‡¸å‡½æ•°, å› æ­¤æ— è®ºåœ¨å“ªé‡Œåˆå§‹åŒ–æœ€ç»ˆç»“æœå¤§è‡´ç›¸åŒ)
- æœå˜´éƒ½çš„ä¸‹å¡æ–¹å‘èµ°ä¸€æ­¥, ä¸æ–­è¿­ä»£
- çŸ¥é“èµ°åˆ°å…¨å±€æœ€ä¼˜è§£æˆ–è€…æ¥è¿‘å…¨å±€æœ€ä¼˜è§£çš„åœ°æ–¹

**æš‚ä¸”å¿½ç•¥å‚æ•°b, åªè€ƒè™‘ä¸€ç»´çš„w**

$w :=\omega-\alpha \frac{d J(a)}{d w}$

- $\alpha$è¡¨ç¤ºå­¦ä¹ ç‡, ç”¨æ¥æ§åˆ¶è¡¥å¿
- $\frac{d J(w)}{d w}$æ˜¯å‡½æ•°J(w)å¯¹wæ±‚å¯¼

- å½“éšæœºç‚¹ä½äºæœ€å°å€¼å³ä¾§æ—¶, æ–œç‡(å¯¼æ•°)å¤§äºé›¶, æ¯æ¬¡wå‡å°ä¸€ç‚¹, å¾€å·¦ç§»ä¸€ç‚¹, ç›´åˆ°åˆ°è¾¾æœ€ä½ç‚¹

  ![image.png](https://upload-images.jianshu.io/upload_images/12014150-a8228033527f0571.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- å½“éšæœºç‚¹ä½äºæœ€å°å€¼å·¦ä¾§æ—¶, æ–œç‡(å¯¼æ•°)å°äºé›¶, æ¯æ¬¡wå¢å¤§ä¸€ç‚¹, å¾€å³ç§»ä¸€ç‚¹, ç›´åˆ°åˆ°è¾¾æœ€ä½ç‚¹

  ![image.png](https://upload-images.jianshu.io/upload_images/12014150-7afb2c968168690c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

**è€ƒè™‘wå’Œbä¸¤ä¸ªå‚æ•°**

$w :=w-a \frac{\partial J(w, b)}{\partial w}$

$b :=b-a \frac{\partial J(w, b)}{\partial b}$