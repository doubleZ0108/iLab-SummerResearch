# *ilab*åŒ»å­¦å½±åƒæš‘æœŸç§‘ç ”

2019-07-23 å¼ å–†å­¦ä¹ ç¬”è®°


Table of Contents
=================

   * [<em>ilab</em>åŒ»å­¦å½±åƒæš‘æœŸç§‘ç ”](#ilabåŒ»å­¦å½±åƒæš‘æœŸç§‘ç ”)
   * [ç¬¬ä¸€é—¨è¯¾ ç¥ç»ç½‘è·¯å’Œæ·±åº¦å­¦ä¹ ](#ç¬¬ä¸€é—¨è¯¾-ç¥ç»ç½‘è·¯å’Œæ·±åº¦å­¦ä¹ )
      * [ç¬¬äºŒå‘¨: ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€](#ç¬¬äºŒå‘¨-ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€)
         * [å‘é‡åŒ–](#å‘é‡åŒ–)
            * [å‘é‡åŒ–çš„ä¾‹å­](#å‘é‡åŒ–çš„ä¾‹å­)
         * [å‘é‡åŒ–çš„é€»è¾‘å›å½’](#å‘é‡åŒ–çš„é€»è¾‘å›å½’)
            * [å‰å‘ä¼ æ’­çš„å‘é‡åŒ–](#å‰å‘ä¼ æ’­çš„å‘é‡åŒ–)
            * [æ¢¯åº¦ä¸‹é™çš„å‘é‡åŒ–](#æ¢¯åº¦ä¸‹é™çš„å‘é‡åŒ–)
            * [é€»è¾‘å›å½’çš„å‘é‡åŒ–](#é€»è¾‘å›å½’çš„å‘é‡åŒ–)
         * [å¹¿æ’­](#å¹¿æ’­)
         * [python - numpyå‘é‡](#python---numpyå‘é‡)
            * [å¹¿æ’­çš„ä¼˜ç¼ºç‚¹](#å¹¿æ’­çš„ä¼˜ç¼ºç‚¹)
            * [ä¸€ç»´æ•°ç»„ä¸å‘é‡çš„ä¸åŒç‚¹](#ä¸€ç»´æ•°ç»„ä¸å‘é‡çš„ä¸åŒç‚¹)

# ç¬¬ä¸€é—¨è¯¾ ç¥ç»ç½‘è·¯å’Œæ·±åº¦å­¦ä¹ 

## ç¬¬äºŒå‘¨: ç¥ç»ç½‘ç»œçš„ç¼–ç¨‹åŸºç¡€

### å‘é‡åŒ–

#### å‘é‡åŒ–çš„ä¾‹å­

ä¾‹1. è®¡ç®—$z=w^{T} x+b$

```python
import numpy as np

# æš´åŠ›å¾ªç¯æ³•
def forloop(w,x,b):
    z = 0
    for i in range(len(x)):
        z += w[i]*x[i]
    z += b

# å‘é‡æ³•
def vector(w,x,b):
    z = np.dot(w,x) + b

if __name__ == "__main__":
    w = [w for w in range(1,1000)]
    x = [x for x in range(1000,1,-1)]
    b = 100

    forloop(w,x,b)
    vector(w,x,b)
```

> ä½†å®é™…æµ‹è¯•è¿‡å, å°†æ¯ç§ç®—æ³•æ‰§è¡Œ5000æ¬¡, è¿è¡Œç»“æœå¦‚ä¸‹:
>
> Time forloop: 5.08
> Time vector: 7.18

ä½†æ˜¯å¦‚æœå°†äº§ç”Ÿæ•°ç»„çš„æ–¹å¼æ›´æ¢ä¸º

```python
w = np.random.rand(1000000)
x = np.random.rand(1000000)
```

å‘é‡åŒ–çš„ç‰ˆæœ¬è¿è¡Œæ•ˆç‡æ˜¾è‘—æå‡, æ•ˆç‡æå‡äº†å¤§è‡´300å€

> Time forloop: 3.23 
> Time vector: 0.01

ä¾‹2. u = Av, u,vå‡ä¸ºå‘é‡, Aä¸ºçŸ©é˜µ, ä¾‹Açš„ç»´åº¦ä¸º2\*3, vä¸º3\*1, ç»“æœuä¸º2*1

```python
import numpy as np

def vector():
    A = np.array([[1,2,3],[4,5,6]])
    v = np.array([[4],[5],[6]])
    u = np.zeros((2,1))

    u = np.dot(A,v)
    print(u)
    
def forloop():
    A = [
        [1,2,3],
        [4,5,6],
    ]

    v = [
        [4],
        [5],
        [6],
    ]

    u = [
        [0],
        [0],
    ]

    for i in range(len(A)):
        for j in range(len(A[i])):
            print(A[i][j])
            print(v[j][0])
            u[i][0] += A[i][j] * v[j][0]
    print(u)
```

ä¾‹3. æœ‰ä¸€ä¸ªå‘é‡v, æƒ³å¯¹vçš„æ¯ä¸ªå…ƒç´ åšæŒ‡æ•°è¿ç®—

```python
u = np.exp(v)
```

`numpy`åº“ä¸­è¿˜æœ‰å¾ˆå¤šå‘é‡å‡½æ•°`np.log()`, `np.abs()`......

### å‘é‡åŒ–çš„é€»è¾‘å›å½’

#### å‰å‘ä¼ æ’­çš„å‘é‡åŒ–

Z = np.dot(w.T, X) + b

bæ˜¯ä¸€ä¸ªå®æ•°(1\*1çš„çŸ©é˜µ), ä½†æ˜¯å½“å‘é‡åŠ ä¸Šä¸€ä¸ªå®æ•°æ—¶, pythonä¼šè‡ªåŠ¨æŠŠè¿™ä¸ªå®æ•°æ‰©å±•æˆä¸€ä¸ª1\*mçš„è¡Œå‘é‡

#### æ¢¯åº¦ä¸‹é™çš„å‘é‡åŒ–

dw = 1/m * X * dz.T

db = 1/m * np.sum(dZ)

#### é€»è¾‘å›å½’çš„å‘é‡åŒ–

**å¾ªç¯æ–¹æ³•**

```python
J,dw1,dw2,db = 0,0,0,0
for i in range(0,m):
    z[i] = w*x[i] + b
    a[i] = sigmoid(z[i])
    J += -(y[i]*log(a[i]) + (1-y[i])*log(1-a[i]))
    dz[i] = a[i] - y[i]
    dw1 += x1[i] * dz[i]
    dw2 += x2[i] * dz[i]
    db += dz[i]
J /= m
dw1 /= m
dw2 /= m
db /=m

w -= alpha * dw
b -= alpha * db
```

**ä½¿ç”¨å‘é‡è¡¨ç¤º**

```python
# å¯¹è®­ç»ƒæ ·æœ¬è¿›è¡Œé¢„æµ‹å’Œæ±‚å¯¼
Z = np.dot(w.T, X) + b
A = ğœ(Z)
dZ = A - Y
dw = 1/m * X * dz.T
db = 1/m * np.sum(dZ)
# æ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°
w -= alpha * dw
b -= alpha * db
```

### å¹¿æ’­

ä¾‹. è®¡ç®—ä¸åŒé£Ÿç‰©ä¸­ä¸åŒè¥å…»æ’åˆ†ä¸­çš„å¡äº†å‹åŠ›ç™¾åˆ†æ¯”

![image.png](https://upload-images.jianshu.io/upload_images/12014150-406e19a5bc2da39e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

```python
import numpy as np

A = np.array([[56.0, 0.0, 4.4, 68.0],
              [1.2, 104.0, 52.0, 8.0],
              [1.8, 135.0, 99.0, 0.9]])

cal = A.sum(axis = 0)   # 0ä¸ºæŒ‰åˆ—è®¡ç®—, 1ä¸ºæŒ‰è¡Œè®¡ç®—

percentage = A / cal.reshape(1,4)
print(percentage)
```

- æ¯”å¦‚è®¡ç®—è‹¹æœä¸­å¡è·¯é‡Œæ‰€å çš„ç™¾åˆ†æ¯”, å…ˆè®¡ç®—56.0+1.2+1.8 = 59; 56/59 = 0.949
- è®¡ç®—ç™¾åˆ†æ¯”æ—¶: å°†3\*4çš„çŸ©é˜µAåˆä¸€ä¸€ä¸ª1\*4çš„çŸ©é˜µ, å¾—åˆ°äº†ä¸€ä¸ª3\*4çš„ç»“æœçŸ©é˜µ, å³ä¸ºæ‰€æ±‚
- ç†è®ºä¸Š`cal`æœ¬èº«æ˜¯ä¸€ä¸ª1\*4çš„å‘é‡, ä¸éœ€è¦å†è¿›è¡Œreshape, ä½†æ˜¯å½“æˆ‘ä»¬å†™ä»£ç ä¸ç¡®å®šçŸ©é˜µç»´åº¦çš„æ—¶å€™, å¯ä»¥å¯¹çŸ©é˜µè¿›è¡Œé‡å¡‘æ¥ç¡®ä¿å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„çŸ©é˜µ, è€Œreshapeçš„æ—¶é—´å¤æ‚åº¦æ˜¯`O(1)`, è°ƒç”¨ä»£ä»·æä½

**å¹¿æ’­æœºåˆ¶**

- ä¸€ä¸ª4\*1çš„åˆ—å‘é‡ä¸ä¸€ä¸ªå¸¸æ•°åšåŠ æ³•æ—¶, ä¼šå°†å¸¸æ•°æ‰©å±•ä¸ºä¸€ä¸ª4*1çš„åˆ—å‘é‡, ç„¶åå†æŒ‰ç…§çŸ©é˜µçš„åŠ æ³•è¿›è¡Œ

- å¹¿æ’­æœºåˆ¶å¯¹ä¸åˆ—å‘é‡å’Œè¡Œå‘é‡å‡å¯ä»¥ä½¿ç”¨

  ![image.png](https://upload-images.jianshu.io/upload_images/12014150-b216b1a925fd3e2c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

  ![image.png](https://upload-images.jianshu.io/upload_images/12014150-0822a8eeeb6eca86.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

  ![image.png](https://upload-images.jianshu.io/upload_images/12014150-ee82d278d570e114.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- åç¼˜ç»´åº¦çš„è½´é•¿åº¦: `A.shape[-1]`, å³åˆ—æ•°;   

  **<u>å¦‚æœä¸¤ä¸ªæ•°ç»„çš„åé™¢ç»´åº¦çš„è½´é•¿åº¦ç›¸ç¬¦æˆ–å…¶ä¸­ä¸€æ–¹çš„è½´é•¿åº¦ä¸º1, åˆ™è®¤ä¸ºä»–ä»¬æ˜¯å¹¿æ’­å…¼å®¹çš„, å¹¿æ’­ä¼šåœ¨ç¼ºå¤±ç»´åº¦å’Œè½´é•¿åº¦ä¸º1çš„ç»´åº¦ä¸Šè¿›è¡Œ</u>***

  å¡è·¯é‡Œçš„ä¾‹å­ä¸­A<sub>3*4</sub>çš„åç¼˜ç»´åº¦çš„è½´é•¿åº¦ç­‰äº4; è€Œcal<sub>1*4</sub>çš„åç¼˜ç»´åº¦ä¹Ÿæ˜¯4, äºŒè€…çš„åç¼˜ç»´åº¦è½´é•¿åº¦ç›¸ç¬¦, å› æ­¤å¯ä»¥è¿›è¡Œå¹¿æ’­

  å¹¿æ’­ä¼šåœ¨è½´é•¿åº¦ä¸º1çš„ç»´åº¦å¯¹åº”`axis=0`å³å‚ç›´æ–¹å‘, å¤åˆ¶æˆcal_temp<sub>3*4</sub>, ä¹‹åäºŒè€…å†è¿›è¡Œè¿ç®—

### python - numpyå‘é‡

#### å¹¿æ’­çš„ä¼˜ç¼ºç‚¹

- å·¨å¤§çš„çµæ´»æ€§

- ä¸ç†Ÿæ‚‰çš„è¯å¯èƒ½æœ‰å¥‡æ€ªçš„bug

  æ¯”å¦‚ä¸€ä¸ªnç»´åˆ—å‘é‡åŠ ä¸Šä¸€ä¸ªnç»´è¡Œå‘é‡, ä¸ä¼šæŠ¥ç»´åº¦ä¸åŒ¹é…æˆ–ç±»å‹é”™è¯¯ä¹‹ç±»çš„é”™è¯¯, è€Œæ˜¯å¾—åˆ°äº†å¹¿æ’­åçš„ç»“æœ

```python
import numpy as np

A = np.array([1,2,3])
B = np.array([[1],[2],[3]])
result = A + B
print(result)
'''
Output:
[[2 3 4]
 [3 4 5]
 [4 5 6]]
'''
```

#### ä¸€ç»´æ•°ç»„ä¸å‘é‡çš„ä¸åŒç‚¹

ä¸€ç»´æ•°ç»„    â—â—â—**(åœ¨ç¥ç»ç½‘ç»œä¸­ä¸è¦ä½¿ç”¨)**

- å®ƒä¸æ˜¯è¡Œå‘é‡ä¹Ÿä¸æ˜¯åˆ—å‘é‡
- è½¬ç½®åè·Ÿå®ƒæœ¬èº«çœ‹èµ·æ¥ä¸€æ ·
- aä¹˜ä»¥açš„è½¬ç½®è¿”å›çš„æ˜¯å†…ç§¯ --> ä¸€ä¸ªæ•°

```python
import numpy as np

a = np.random.randn(5)
print(a)    # [-1.225  0.282 -0.958  1.176 -0.707]
print(a.shape)  # (5,)
print(a.T)  # [-1.225  0.282 -0.958  1.176 -0.707]
print(np.dot(a, a.T))   # 4.385
```

åˆ—å‘é‡

- æˆ‘ä»¬è®¾ç½®å®ƒçš„shapeä¸º(5,1)
- è¿™æ ·è¾“å‡ºå®ƒçš„è½¬ç½®æ—¶æœ‰ä¸¤ä¸ª[[ ]], å®ƒå˜æˆä¸€ä¸ªè¡Œå‘é‡äº†
- äºŒè€…çš„ä¹˜ç§¯è¿”å›çš„æ˜¯å¤–ç§¯ --> ä¸€ä¸ªçŸ©é˜µ

```python
import numpy as np

a = np.random.randn(5,1)
print(a)    '''
            [[ 0.03078465]
            [ 0.52937981]
            [-1.29145158]
            [-0.3743261 ]
            [ 0.46156606]]
            '''
print(a.shape)  # (5,1)
print(a.T)  # [[ 0.03078465  0.52937981 -1.29145158 -0.3743261   0.46156606]]
print(np.dot(a, a.T))   '''
                        [[ 9.47694739e-04  1.62967726e-02 -3.97568863e-02 -1.15234983e-02 1.42091501e-02]
                        [ 1.62967726e-02  2.80242978e-01 -6.83668388e-01 -1.98160677e-01 2.44343752e-01]
                        [-3.97568863e-02 -6.83668388e-01  1.66784719e+00  4.83424032e-01 -5.96090221e-01]
                        [-1.15234983e-02 -1.98160677e-01  4.83424032e-01  1.40120028e-01 -1.72776223e-01]
                        [ 1.42091501e-02  2.44343752e-01 -5.96090221e-01 -1.72776223e-01 2.13043229e-01]]
                        '''
```

å¦‚æœä¸ç¡®å®šè¡Œ/åˆ—å‘é‡æ˜¯å¦shapeæœ‰ç¬¬äºŒä¸ªç»´åº¦(ä¸æ˜¯ä¸€ç»´æ•°ç»„), å¯ä»¥åŠ å…¥æ–­è¨€`assert(a.shape == (5,1))`, æˆ–è€…reshape `a = np.random.randn(5).reshape(5,1)`
